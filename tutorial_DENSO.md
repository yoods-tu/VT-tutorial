| VTチュートリアル ロボット接続編(DENSO) | Revision      | 第1版 |
| -------------------------------------- | ------------- | ----- |
| 作成者                                 | 株式会社YOODS |       |
| 作成日                                 | 2024年3月25日 |       |
| 最終更新日                             | 2024年3月25日 |       |

# 7. データ通信設定 ( DENSO )

|  No  | 手順                                                                                                                                                                                                                                                                                                                                                                                                                 | 補足                                                                                                                                                                    |
| :--: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| A140 | ロボットのIPアドレスを設定します。<br /><br />  初期画面の下部 「 設定 」 メニューから　　　　　　　　　　　　　　<br />下記の順で選択してください。<br /><br />   １．「 通信と起動権 」  <br /><br />  ２．「 ネットワークと通信権 」  　　　　　　　　　　　　　                                                                                                                                               | ![1724129501848](image/tutorial_DENSO/1724129501848.png)<br />![1724129521739](image/tutorial_DENSO/1724129521739.png)                                                      |
| A141 | イーサネットを選択、下記項目を設定。<br />  通     信     権：読込/書込可<br /><br />D　H　C　P：無効<br /><br />IP   アドレス：192.168.221.10<br /><br />サブネットマスク：255.255.255.0                                                                                                                                                                                                                   | ![1724129544258](image/tutorial_DENSO/1724129544258.png)<br />※IPアドレスはデフォルト値です。                                                                            |
| A142 | データ通信設定を行います。<br /><br />  初期画面の下部 「 設定 」 メニューから <br />下記の順で選択してください。 <br /><br />１．「 通信と起動権 」<br /><br />  ２．「 データ通信 」                                                                                                                                                                                                                               | <br />![1724129572874](image/tutorial_DENSO/1724129572874.png)                                                                                                            |
| A143 | デバイス：イーサネットを選択<br />サーバ回線の設定を行います。<br />「サーバ回線番号４」を選択、右記項目を設定。　　　　　　<br />　　                                                                                                                                                                                                                                                                               | T C P / U D P：TCP<br />ポ 　 ー　 ト：50000<br />データタイプ：テキスト<br />デリミタ：LF                                                                              |
| A144 | デバイス：イーサネットを選択<br />クライアント回線の設定を行います。<br />「クライアント回線15」を選択、右記項目を設定。              　　　　　　　　　　　　　　　<br /><br />※IPアドレスはデフォルト値です。<br />　クライアント回線で設定するIPアドレスは　　　　　　　　　　　　　　　　　　　　　　　<br />　PCのIPアドレスです。<br />　チュートリアルA1-ロボット接続A114を<br />　参照してください。 | TCP/UDP：TCP<br /><br />IPｱﾄﾞﾚｽ：192.168.221.2<br /><br />ポ　  ー　  ト：8888<br /><br />データタイプ：テキスト<br /><br />デリミタ：LF<br /><br />ヘッダ：なし |

# 8.プログラムのロード ( DENSO )

|      | 手順                                                                                                                                                                                                                                                                                                                                              | 補足                                                                                                                                                                                                                                                                                                                                                                              |
| ---- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| A150 | PCデスクトップ「VTマニュアル」のリンクを選択して<br />ダブルクリックしてください。 <br />　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　<br />  使用するロボットメーカーのフォルダを開き <br />「Robot_program」のフォルダを開いてください。                               | ※ロボットコントローラとWINCAPSが接続、使用<br />出来る環境をご準備ください。                                                                                                                                                                                                   |
| A151 | PCへUSBメモリを挿してください。<br /><br />  robot_programフォルダ内の <br />プログラムファイルを全てUSBへ <br />コピーしてください。<br /><br />  コピー完了後、USBを抜いてください。                                                                                                                                                            | USBメモリフォルダは自動で出てきますが<br />出ない場合、ファイルマネージャーを開いて <br />デバイス内のUSBフォルダを開いてください。<br /><br />  USBを抜く際は、ファイルマネージャー左側メニュー <br />   デバイス内にあるUSBの <br />![1724130934532](image/tutorial_DENSO/1724130934532.png)マークを押してから抜いてください。                                                    |
| A152 | WINCAPSを使用しているPCへ<br />コピーしたプログラムファイルを移行し <br />WINCAPSの画面から <br />コピーしたプログラムをインポートしてください。<br /><br />  インポート後、右記のプログラムを <br />ロボットへ送信してください。<br /><br /><br />プログラムはルートフォルダに置いてください。                                                   | プログラム<br />●VTSample.pcs<br />●VTMove.pcs<br />●rovi.pcs<br />●RCalib.pcs<br />●RCalibAuto.pcs<br />●tsr0011.pcs                                                                                                                                                                                                                                                       |
| A153 | 操作盤パネルプログラムを使用すると<br />TPから撮影等が実行できます。<br />ご使用の 「Main.pns9」 から<br />「rovi_panel.pns9」 を呼び出すように<br />変更してください。                                                                                                                                                                           | 操作盤パネルプログラム<br />●rovi_panel.pns9                                                                                                                                                                                                                                                                                                                                     |
| A154 | WINCAPSのPanelDesignerで<br />「Main.pns9」へ右記コマンドを追加してください。                                                                                                                                                                                                                                                                     | プッシュボタンを追加する場合<br /><br />Sub PB1_CLICKED()<br />        PageChange rovi_panel<br />End Sub                                                                                                                                                                                                                                                                   |

# 9. 特権タスク設定 ( DENSO )

|  No  | 手順                                                                                                                                                                                                                                                                                           | 補足                                                                                                                                                                                                                                                                                                                                                                                         |
| :--: | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| A160 | PCへロボットの現在値（軸値）を<br />送信するため特権タスクを実行させます。             　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　                                <br /><br />  特権タスクで使用しているプログラムは <br />「tsr0011.pcs」 です。 | ※VTの機能を使用する時は<br />　特権タスクが起動されている事を確認してください。                                                                                                                                                             　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　 |
| A161 | 初期画面の下部 「 プログラム 」 メニューを選択<br /><br />  下部　「　補助機能　」　を選択し、 <br />プログラム補助機能画面を開いてください。 <br /><br />  「　プログラムパラメータ　」を選択してください。                                                                                   | ![1724131164924](image/tutorial_DENSO/1724131164924.png)                                                                                                                                                                                                                                                                                                                                       |
| A162 | 項目名<br />「32.タスク終了時の通信回線自動切断」を <br />選択し、編集を押してください。 <br /><br />  「有効　１」 に設定後、プログラムパラメータ画面 <br />下部 「OK」 ボタンを押して <br />設定を完了させてください。                                                                       | ![1724204029455](image/tutorial_DENSO/1724204029455.png)                                                                                                                                                                                                                                                                                                                                       |
| A163 | 初期画面の下部 「 プログラム 」 メニューを選択<br /><br />  下部 「 補助機能 」 を選択し、 <br />プログラム補助機能画面を開いてください。<br /><br />   「 プログラム設定 」を選択してください。                                                                                               | ![1724131532254](image/tutorial_DENSO/1724131532254.png)                                                                                                                                                                                                                                                                                                                                       |
| A164 | プログラム設定画面の上部<br />「 特権タスク 」 を選択してください。<br /><br />  下記、表の設定を行ってください。                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                                                                              |

| **項目**                                                | **設定内容**                                 |
| ------------------------------------------------------------- | -------------------------------------------------- |
| 1. 電源立ち上げ時の起動設定                                   | ルートのみ起動                                     |
| 2. 電源立ち上げ時にエラー発生した場合の起動設定          | 起動する                                           |
| 3. 自動モード切替時の起動設定                                 | ルートのみ起動                                     |
| 4. 電源エラー発生時の停止対象                                 | 全特権タスク                                       |
| 5. 特権タスク実行中のI/O出力設定                              | 任意（特権タスク起動中を監視したい場合はONに設定） |

| A165 | 特権タスクはプログラム保存の操作を<br />行うと停止されます。                                                                           <br /><br />  停止後は、再度特権タスクを起動してください。       | <br /><br />                                                                                                                                                                                                                                                 <br />                                         |
| :--- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| A166 | 特権タスク停止状態でPCから<br />撮影を実行すると、ロボットからの軸値送信が <br />できていないため 「901」 エラーが <br />発生します。 <br /><br />  エラー発生時は特権タスクを起動してください。                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                           |

# 10. 動作確認

|  No  | 手順                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                     補足                                                                                                                                                                                                                     |
| :--: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: |
| A170 | デスクトップのVT起動アイコンをダブルクリックして、　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　<br />ビジュアルコントローラを起動します。                                                <br />  <br /> ※起動済みの場合は、念のため再起動 |                                           　　　　　　　　　　　　　　　　　　　　　　　　　　　![1724132479205](https://file+.vscode-resource.vscode-cdn.net/c%3A/Users/tuchiyama/Desktop/md_manual/image/tutorial_DENSO/1724132479205.png)　　　　　　　　　　　　　　　　　　　　　　　　　　　                                                                  <br />VT起動アイコン |
| A171 | ご使用のロボットが画面に表示されることを<br />確認します。                                                                                                                                                                                                                             |                                                                                                                                                                         ![1724132525621](image/tutorial_DENSO/1724132525621.png)<br />画面上にロボットが表示されます。                                                                                                                                                                         |
| A172 | TPでロボットを動かし、画面上のロボットと<br />実際のロボットの動きが連動していることを <br />確認してください。                                                                                                                                                                        |                                                                                                                                                                                    各軸座標系で6軸それぞれを動かし<br /> 連動しているか確認してください。                                                                                                                                                                                    |
| A173 | これで接続は全て完了です。                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                                              |
